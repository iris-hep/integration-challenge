CommonServices:
    systematicsHistogram: 'listOfSystematics'
    enableExpertMode: True
    filterSystematics: "^(EG_|EL_|MUON_|FT_|JET_|MET_).*$|^$"
    # onlySystematicsCategories:
    #   - jets
    #   - ftag
    #   - met
    #   - electrons
    #   - muons
    #   - event

PileupReweighting: {}

EventCleaning:
    runEventCleaning: True
    userGRLFiles:
      # https://twiki.cern.ch/twiki/bin/view/AtlasProtected/GoodRunListsForAnalysisRun2
      - 'GoodRunsLists/data15_13TeV/20170619/data15_13TeV.periodAllYear_DetStatus-v89-pro21-02_Unknown_PHYS_StandardGRL_All_Good_25ns.xml'
      - 'GoodRunsLists/data16_13TeV/20180129/data16_13TeV.periodAllYear_DetStatus-v89-pro21-01_DQDefects-00-02-04_PHYS_StandardGRL_All_Good_25ns.xml'
      - 'GoodRunsLists/data17_13TeV/20180619/data17_13TeV.periodAllYear_DetStatus-v99-pro22-01_Unknown_PHYS_StandardGRL_All_Good_25ns_Triggerno17e33prim.xml'
      - 'GoodRunsLists/data18_13TeV/20190318/data18_13TeV.periodAllYear_DetStatus-v102-pro22-04_Unknown_PHYS_StandardGRL_All_Good_25ns_Triggerno17e33prim.xml'
      # https://twiki.cern.ch/twiki/bin/view/AtlasProtected/GoodRunListsForAnalysisRun3
      - 'GoodRunsLists/data22_13p6TeV/20250321/data22_13p6TeV.periodAllYear_DetStatus-v134-pro28-09_MERGED_PHYS_StandardGRL_All_Good_25ns.xml'
      - 'GoodRunsLists/data23_13p6TeV/20250321/data23_13p6TeV.periodAllYear_DetStatus-v133-pro31-11_MERGED_PHYS_StandardGRL_All_Good_25ns.xml'
      - 'GoodRunsLists/data24_13p6TeV/20241118/physics_25ns_data24.xml'

GeneratorLevelAnalysis: {}

Jets:
  - containerName: 'AnaJets'
    jetCollection: 'AntiKt4EMPFlowJets'
    runJvtUpdate: False
    runNNJvtUpdate: True
    runGhostMuonAssociation: True
    Uncertainties:
      systematicsModelJES: 'Category'
      systematicsModelJER: 'Full'
    JVT: {}
    PtEtaSelection:
        minPt: 25000.0
        maxEta: 2.5
    FlavourTagging:
      - btagger: 'GN2v01'
        btagWP: 'FixedCutBEff_90'
      - btagger: 'GN2v01'
        btagWP: 'FixedCutBEff_85'
      - btagger: 'GN2v01'
        btagWP: 'FixedCutBEff_77'
      - btagger: 'GN2v01'
        btagWP: 'FixedCutBEff_70'
      - btagger: 'GN2v01'
        btagWP: 'FixedCutBEff_65'
      - btagger: 'GN2v01'
        btagWP: 'Continuous'
    FlavourTaggingEventSF:
      - containerName: 'AnaJets.baselineJvt'
        btagger: 'GN2v01'
        btagWP: 'Continuous'
        # generator: 'default'  # for 545027/8

Electrons:
  - containerName: 'AnaElectrons'
    crackVeto: True
    IFFClassification: {}
    WorkingPoint:
      - selectionName: 'tight'
        identificationWP: 'TightLH'
        isolationWP: 'Tight_VarRad'
        correlationModelId: 'TOTAL'
        correlationModelIso: 'TOTAL'
        correlationModelReco: 'TOTAL'
        forceFullSimConfig: True  # for v1.1
    PtEtaSelection:
        minPt: 25000.
        maxEta: 2.47
        useClusterEta: True

Muons:
  - containerName: 'AnaMuons'
    IFFClassification: {}
    WorkingPoint:
      - selectionName: 'tight'
        quality: 'Medium'
        isolation: 'Tight_VarRad'
    PtEtaSelection:
        minPt: 25000.0
        maxEta: 2.5

MissingET:
  - containerName: 'AnaMET'
    # Format should follow Object: '<containerName>.<postfix>'
    jets: 'AnaJets'
    electrons: 'AnaElectrons.tight'
    muons: 'AnaMuons.tight'

# containerName and postfix must be defined in their respective blocks
OverlapRemoval:
    inputLabel: 'preselectOR'
    outputLabel: 'passesOR'
    # Format should follow Object: '<containerName>.<postfix>'
    jets: 'AnaJets.baselineJvt'
    electrons: 'AnaElectrons.tight'
    muons: 'AnaMuons.tight'

# ObjectCutFlow:
#   - containerName: 'AnaElectrons'
#     selectionName: 'tight'
#   - containerName: 'AnaMuons'
#     selectionName: 'tight'
#   - containerName: 'AnaJets'
#     selectionName: 'baselineJvt'

Thinning:
  - containerName: 'AnaJets'
    outputName: 'OutJets'
    selectionName: 'baselineJvt'
  - containerName: 'AnaElectrons'
    outputName: 'OutElectrons'
    selectionName: 'tight'
  - containerName: 'AnaMuons'
    outputName: 'OutMuons'
    selectionName: 'tight'

LeptonSF:
  - electrons: 'AnaElectrons.tight'
    muons: 'AnaMuons.tight'
  # photons: 'AnaPhotons.tight'
    lepton_postfix: 'tight'

Trigger:
    triggerChainsPerYear:  # https://twiki.cern.ch/twiki/bin/viewauth/Atlas/LowestUnprescaled
      '2015':
        - 'HLT_e24_lhmedium_L1EM20VH || HLT_e60_lhmedium || HLT_e120_lhloose'
        - 'HLT_mu20_iloose_L1MU15 || HLT_mu40'
      '2016':
        - 'HLT_e26_lhtight_nod0_ivarloose || HLT_e60_lhmedium_nod0 || HLT_e140_lhloose_nod0'
        - 'HLT_mu26_ivarmedium || HLT_mu50'
      '2017':
        - 'HLT_e26_lhtight_nod0_ivarloose || HLT_e60_lhmedium_nod0 || HLT_e140_lhloose_nod0'
        - 'HLT_mu26_ivarmedium || HLT_mu50'
      '2018':
        - 'HLT_e26_lhtight_nod0_ivarloose || HLT_e60_lhmedium_nod0 || HLT_e140_lhloose_nod0'
        - 'HLT_mu26_ivarmedium || HLT_mu50'
      # Run-3 recomendations: https://twiki.cern.ch/twiki/bin/view/Atlas/  TrigEgammaRecommendationsRun3
      '2022':
        - 'HLT_e26_lhtight_ivarloose_L1EM22VHI || HLT_e60_lhmedium_L1EM22VHI || HLT_e140_lhloose_L1EM22VHI'
        - 'HLT_mu24_ivarmedium_L1MU14FCH || HLT_mu50_L1MU14FCH'
      '2023':
        - 'HLT_e26_lhtight_ivarloose_L1eEM26M || HLT_e60_lhmedium_L1eEM26M || HLT_e140_lhloose_L1eEM26M'
        - 'HLT_mu24_ivarmedium_L1MU14FCH || HLT_mu50_L1MU14FCH'
      '2024':
        - 'HLT_e26_lhtight_ivarloose_L1eEM26M || HLT_e60_lhmedium_L1eEM26M || HLT_e140_lhloose_L1eEM26M'
        - 'HLT_mu24_ivarmedium_L1MU14FCH || HLT_mu50_L1MU14FCH'

    noFilter: False
    postfix: '_emu'
    electrons: 'AnaElectrons.tight'
    muons: 'AnaMuons.tight'
    electronID: 'Tight'
    electronIsol: 'Tight_VarRad'
    muonID: 'Medium'

EventSelection:
  - electrons: 'AnaElectrons.tight'
    muons: 'AnaMuons.tight'
    jets: 'AnaJets.baselineJvt'
    met: 'AnaMET'
    btagDecoration: 'ftag_select_GN2v01_FixedCutBEff_85'
    noFilter: False
    cutFlowHistograms: True
    selectionCutsDict:
      'SUBcommon': |
        GLOBALTRIGMATCH _emu
        JET_N 25000 >= 2
        JET_N_BTAG >= 1
        SAVE
      'ejets': |
        IMPORT SUBcommon
        EL_N 27000 >= 1
        JET_N 25000 >= 4
        SAVE
      'mujets': |
        IMPORT SUBcommon
        MU_N 27000 >= 1
        JET_N 25000 >= 4
        SAVE

# After configuring each container, many variables will be saved automatically.
Output:
  treeName: 'reco'
  vars: []
  metVars: []
  containers:
      # Format should follow: '<suffix>:<output container>'
      el_: 'OutElectrons'
      mu_: 'OutMuons'
      jet_: 'OutJets'
      met_: 'AnaMET'
      '': 'EventInfo'
  commands:
      # Turn output branches on and off with 'enable' and 'disable'
      - disable jet_jvtEfficiency.*
      - disable trigPassed_HLT.*
  propertyOverrides:
    TreeMaker.TreeAutoFlush: 2000
  defaultBasketSize: 128000

AddConfigBlocks: []
